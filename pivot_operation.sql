-- Instructions:

-- 1. Open QGIS > DB Manager
-- 2. Right-click Geopackage > Connect > add "math_panic_buying.gpkg"
-- 3. Open a SQL Query window
-- 4. Complete the query below
-- 5. Copy-n-paste and execute this query
-- 6. Save table to new CSV
-- 7. Table join based on state name spatial layer


select 
    state, 
    	sum(case when month='2020-10' then handgun end) as handgun_2020_10,
	sum(case when month='2020-10' then rifle end) as rifle_2020_10,
	sum(case when month='2020-10' then total end) as total_2020_10,
	sum(case when month='2020-09' then handgun end) as handgun_2020_09,
	sum(case when month='2020-09' then rifle end) as rifle_2020_09,
	sum(case when month='2020-09' then total end) as total_2020_09,
	sum(case when month='2020-08' then handgun end) as handgun_2020_08,
	sum(case when month='2020-08' then rifle end) as rifle_2020_08,
	sum(case when month='2020-08' then total end) as total_2020_08,
	sum(case when month='2020-07' then handgun end) as handgun_2020_07,
	sum(case when month='2020-07' then rifle end) as rifle_2020_07,
	sum(case when month='2020-07' then total end) as total_2020_07,
	sum(case when month='2020-06' then handgun end) as handgun_2020_06,
	sum(case when month='2020-06' then rifle end) as rifle_2020_06,
	sum(case when month='2020-06' then total end) as total_2020_06,
	sum(case when month='2020-05' then handgun end) as handgun_2020_05,
	sum(case when month='2020-05' then rifle end) as rifle_2020_05,
	sum(case when month='2020-05' then total end) as total_2020_05,
	sum(case when month='2020-04' then handgun end) as handgun_2020_04,
	sum(case when month='2020-04' then rifle end) as rifle_2020_04,
	sum(case when month='2020-04' then total end) as total_2020_04,
	sum(case when month='2020-03' then handgun end) as handgun_2020_03,
	sum(case when month='2020-03' then rifle end) as rifle_2020_03,
	sum(case when month='2020-03' then total end) as total_2020_03,
	sum(case when month='2020-02' then handgun end) as handgun_2020_02,
	sum(case when month='2020-02' then rifle end) as rifle_2020_02,
	sum(case when month='2020-02' then total end) as total_2020_02,
	sum(case when month='2020-01' then handgun end) as handgun_2020_01,
	sum(case when month='2020-01' then rifle end) as rifle_2020_01,
	sum(case when month='2020-01' then total end) as total_2020_01,
	sum(case when month='2019-12' then handgun end) as handgun_2019_12,
	sum(case when month='2019-12' then rifle end) as rifle_2019_12,
	sum(case when month='2019-12' then total end) as total_2019_12,
	sum(case when month='2019-11' then handgun end) as handgun_2019_11,
	sum(case when month='2019-11' then rifle end) as rifle_2019_11,
	sum(case when month='2019-11' then total end) as total_2019_11,
	sum(case when month='2019-10' then handgun end) as handgun_2019_10,
	sum(case when month='2019-10' then rifle end) as rifle_2019_10,
	sum(case when month='2019-10' then total end) as total_2019_10,
	sum(case when month='2019-09' then handgun end) as handgun_2019_09,
	sum(case when month='2019-09' then rifle end) as rifle_2019_09,
	sum(case when month='2019-09' then total end) as total_2019_09,
	sum(case when month='2019-08' then handgun end) as handgun_2019_08,
	sum(case when month='2019-08' then rifle end) as rifle_2019_08,
	sum(case when month='2019-08' then total end) as total_2019_08,
	sum(case when month='2019-07' then handgun end) as handgun_2019_07,
	sum(case when month='2019-07' then rifle end) as rifle_2019_07,
	sum(case when month='2019-07' then total end) as total_2019_07,
	sum(case when month='2019-06' then handgun end) as handgun_2019_06,
	sum(case when month='2019-06' then rifle end) as rifle_2019_06,
	sum(case when month='2019-06' then total end) as total_2019_06,
	sum(case when month='2019-05' then handgun end) as handgun_2019_05,
	sum(case when month='2019-05' then rifle end) as rifle_2019_05,
	sum(case when month='2019-05' then total end) as total_2019_05,
	sum(case when month='2019-04' then handgun end) as handgun_2019_04,
	sum(case when month='2019-04' then rifle end) as rifle_2019_04,
	sum(case when month='2019-04' then total end) as total_2019_04,
	sum(case when month='2019-03' then handgun end) as handgun_2019_03,
	sum(case when month='2019-03' then rifle end) as rifle_2019_03,
	sum(case when month='2019-03' then total end) as total_2019_03,
	sum(case when month='2019-02' then handgun end) as handgun_2019_02,
	sum(case when month='2019-02' then rifle end) as rifle_2019_02,
	sum(case when month='2019-02' then total end) as total_2019_02,
	sum(case when month='2019-01' then handgun end) as handgun_2019_01,
	sum(case when month='2019-01' then rifle end) as rifle_2019_01,
	sum(case when month='2019-01' then total end) as total_2019_01,
	sum(case when month='2018-12' then handgun end) as handgun_2018_12,
	sum(case when month='2018-12' then rifle end) as rifle_2018_12,
	sum(case when month='2018-12' then total end) as total_2018_12,
	sum(case when month='2018-11' then handgun end) as handgun_2018_11,
	sum(case when month='2018-11' then rifle end) as rifle_2018_11,
	sum(case when month='2018-11' then total end) as total_2018_11,
	sum(case when month='2018-10' then handgun end) as handgun_2018_10,
	sum(case when month='2018-10' then rifle end) as rifle_2018_10,
	sum(case when month='2018-10' then total end) as total_2018_10,
	sum(case when month='2018-09' then handgun end) as handgun_2018_09,
	sum(case when month='2018-09' then rifle end) as rifle_2018_09,
	sum(case when month='2018-09' then total end) as total_2018_09,
	sum(case when month='2018-08' then handgun end) as handgun_2018_08,
	sum(case when month='2018-08' then rifle end) as rifle_2018_08,
	sum(case when month='2018-08' then total end) as total_2018_08,
	sum(case when month='2018-07' then handgun end) as handgun_2018_07,
	sum(case when month='2018-07' then rifle end) as rifle_2018_07,
	sum(case when month='2018-07' then total end) as total_2018_07,
	sum(case when month='2018-06' then handgun end) as handgun_2018_06,
	sum(case when month='2018-06' then rifle end) as rifle_2018_06,
	sum(case when month='2018-06' then total end) as total_2018_06,
	sum(case when month='2018-05' then handgun end) as handgun_2018_05,
	sum(case when month='2018-05' then rifle end) as rifle_2018_05,
	sum(case when month='2018-05' then total end) as total_2018_05,
	sum(case when month='2018-04' then handgun end) as handgun_2018_04,
	sum(case when month='2018-04' then rifle end) as rifle_2018_04,
	sum(case when month='2018-04' then total end) as total_2018_04,
	sum(case when month='2018-03' then handgun end) as handgun_2018_03,
	sum(case when month='2018-03' then rifle end) as rifle_2018_03,
	sum(case when month='2018-03' then total end) as total_2018_03,
	sum(case when month='2018-02' then handgun end) as handgun_2018_02,
	sum(case when month='2018-02' then rifle end) as rifle_2018_02,
	sum(case when month='2018-02' then total end) as total_2018_02,
	sum(case when month='2018-01' then handgun end) as handgun_2018_01,
	sum(case when month='2018-01' then rifle end) as rifle_2018_01,
	sum(case when month='2018-01' then total end) as total_2018_01,
	sum(case when month='2017-12' then handgun end) as handgun_2017_12,
	sum(case when month='2017-12' then rifle end) as rifle_2017_12,
	sum(case when month='2017-12' then total end) as total_2017_12,
	sum(case when month='2017-11' then handgun end) as handgun_2017_11,
	sum(case when month='2017-11' then rifle end) as rifle_2017_11,
	sum(case when month='2017-11' then total end) as total_2017_11,
	sum(case when month='2017-10' then handgun end) as handgun_2017_10,
	sum(case when month='2017-10' then rifle end) as rifle_2017_10,
	sum(case when month='2017-10' then total end) as total_2017_10,
	sum(case when month='2017-09' then handgun end) as handgun_2017_09,
	sum(case when month='2017-09' then rifle end) as rifle_2017_09,
	sum(case when month='2017-09' then total end) as total_2017_09,
	sum(case when month='2017-08' then handgun end) as handgun_2017_08,
	sum(case when month='2017-08' then rifle end) as rifle_2017_08,
	sum(case when month='2017-08' then total end) as total_2017_08,
	sum(case when month='2017-07' then handgun end) as handgun_2017_07,
	sum(case when month='2017-07' then rifle end) as rifle_2017_07,
	sum(case when month='2017-07' then total end) as total_2017_07,
	sum(case when month='2017-06' then handgun end) as handgun_2017_06,
	sum(case when month='2017-06' then rifle end) as rifle_2017_06,
	sum(case when month='2017-06' then total end) as total_2017_06,
	sum(case when month='2017-05' then handgun end) as handgun_2017_05,
	sum(case when month='2017-05' then rifle end) as rifle_2017_05,
	sum(case when month='2017-05' then total end) as total_2017_05,
	sum(case when month='2017-04' then handgun end) as handgun_2017_04,
	sum(case when month='2017-04' then rifle end) as rifle_2017_04,
	sum(case when month='2017-04' then total end) as total_2017_04,
	sum(case when month='2017-03' then handgun end) as handgun_2017_03,
	sum(case when month='2017-03' then rifle end) as rifle_2017_03,
	sum(case when month='2017-03' then total end) as total_2017_03,
	sum(case when month='2017-02' then handgun end) as handgun_2017_02,
	sum(case when month='2017-02' then rifle end) as rifle_2017_02,
	sum(case when month='2017-02' then total end) as total_2017_02,
	sum(case when month='2017-01' then handgun end) as handgun_2017_01,
	sum(case when month='2017-01' then rifle end) as rifle_2017_01,
	sum(case when month='2017-01' then total end) as total_2017_01,
	sum(case when month='2016-12' then handgun end) as handgun_2016_12,
	sum(case when month='2016-12' then rifle end) as rifle_2016_12,
	sum(case when month='2016-12' then total end) as total_2016_12,
	sum(case when month='2016-11' then handgun end) as handgun_2016_11,
	sum(case when month='2016-11' then rifle end) as rifle_2016_11,
	sum(case when month='2016-11' then total end) as total_2016_11,
	sum(case when month='2016-10' then handgun end) as handgun_2016_10,
	sum(case when month='2016-10' then rifle end) as rifle_2016_10,
	sum(case when month='2016-10' then total end) as total_2016_10,
	sum(case when month='2016-09' then handgun end) as handgun_2016_09,
	sum(case when month='2016-09' then rifle end) as rifle_2016_09,
	sum(case when month='2016-09' then total end) as total_2016_09,
	sum(case when month='2016-08' then handgun end) as handgun_2016_08,
	sum(case when month='2016-08' then rifle end) as rifle_2016_08,
	sum(case when month='2016-08' then total end) as total_2016_08,
	sum(case when month='2016-07' then handgun end) as handgun_2016_07,
	sum(case when month='2016-07' then rifle end) as rifle_2016_07,
	sum(case when month='2016-07' then total end) as total_2016_07,
	sum(case when month='2016-06' then handgun end) as handgun_2016_06,
	sum(case when month='2016-06' then rifle end) as rifle_2016_06,
	sum(case when month='2016-06' then total end) as total_2016_06,
	sum(case when month='2016-05' then handgun end) as handgun_2016_05,
	sum(case when month='2016-05' then rifle end) as rifle_2016_05,
	sum(case when month='2016-05' then total end) as total_2016_05,
	sum(case when month='2016-04' then handgun end) as handgun_2016_04,
	sum(case when month='2016-04' then rifle end) as rifle_2016_04,
	sum(case when month='2016-04' then total end) as total_2016_04,
	sum(case when month='2016-03' then handgun end) as handgun_2016_03,
	sum(case when month='2016-03' then rifle end) as rifle_2016_03,
	sum(case when month='2016-03' then total end) as total_2016_03,
	sum(case when month='2016-02' then handgun end) as handgun_2016_02,
	sum(case when month='2016-02' then rifle end) as rifle_2016_02,
	sum(case when month='2016-02' then total end) as total_2016_02,
	sum(case when month='2016-01' then handgun end) as handgun_2016_01,
	sum(case when month='2016-01' then rifle end) as rifle_2016_01,
	sum(case when month='2016-01' then total end) as total_2016_01,
	sum(case when month='2015-12' then handgun end) as handgun_2015_12,
	sum(case when month='2015-12' then rifle end) as rifle_2015_12,
	sum(case when month='2015-12' then total end) as total_2015_12,
	sum(case when month='2015-11' then handgun end) as handgun_2015_11,
	sum(case when month='2015-11' then rifle end) as rifle_2015_11,
	sum(case when month='2015-11' then total end) as total_2015_11,
	sum(case when month='2015-10' then handgun end) as handgun_2015_10,
	sum(case when month='2015-10' then rifle end) as rifle_2015_10,
	sum(case when month='2015-10' then total end) as total_2015_10,
	sum(case when month='2015-09' then handgun end) as handgun_2015_09,
	sum(case when month='2015-09' then rifle end) as rifle_2015_09,
	sum(case when month='2015-09' then total end) as total_2015_09,
	sum(case when month='2015-08' then handgun end) as handgun_2015_08,
	sum(case when month='2015-08' then rifle end) as rifle_2015_08,
	sum(case when month='2015-08' then total end) as total_2015_08,
	sum(case when month='2015-07' then handgun end) as handgun_2015_07,
	sum(case when month='2015-07' then rifle end) as rifle_2015_07,
	sum(case when month='2015-07' then total end) as total_2015_07,
	sum(case when month='2015-06' then handgun end) as handgun_2015_06,
	sum(case when month='2015-06' then rifle end) as rifle_2015_06,
	sum(case when month='2015-06' then total end) as total_2015_06,
	sum(case when month='2015-05' then handgun end) as handgun_2015_05,
	sum(case when month='2015-05' then rifle end) as rifle_2015_05,
	sum(case when month='2015-05' then total end) as total_2015_05,
	sum(case when month='2015-04' then handgun end) as handgun_2015_04,
	sum(case when month='2015-04' then rifle end) as rifle_2015_04,
	sum(case when month='2015-04' then total end) as total_2015_04,
	sum(case when month='2015-03' then handgun end) as handgun_2015_03,
	sum(case when month='2015-03' then rifle end) as rifle_2015_03,
	sum(case when month='2015-03' then total end) as total_2015_03,
	sum(case when month='2015-02' then handgun end) as handgun_2015_02,
	sum(case when month='2015-02' then rifle end) as rifle_2015_02,
	sum(case when month='2015-02' then total end) as total_2015_02,
	sum(case when month='2015-01' then handgun end) as handgun_2015_01,
	sum(case when month='2015-01' then rifle end) as rifle_2015_01,
	sum(case when month='2015-01' then total end) as total_2015_01,
	sum(case when month='2014-12' then handgun end) as handgun_2014_12,
	sum(case when month='2014-12' then rifle end) as rifle_2014_12,
	sum(case when month='2014-12' then total end) as total_2014_12,
	sum(case when month='2014-11' then handgun end) as handgun_2014_11,
	sum(case when month='2014-11' then rifle end) as rifle_2014_11,
	sum(case when month='2014-11' then total end) as total_2014_11,
	sum(case when month='2014-10' then handgun end) as handgun_2014_10,
	sum(case when month='2014-10' then rifle end) as rifle_2014_10,
	sum(case when month='2014-10' then total end) as total_2014_10,
	sum(case when month='2014-09' then handgun end) as handgun_2014_09,
	sum(case when month='2014-09' then rifle end) as rifle_2014_09,
	sum(case when month='2014-09' then total end) as total_2014_09,
	sum(case when month='2014-08' then handgun end) as handgun_2014_08,
	sum(case when month='2014-08' then rifle end) as rifle_2014_08,
	sum(case when month='2014-08' then total end) as total_2014_08,
	sum(case when month='2014-07' then handgun end) as handgun_2014_07,
	sum(case when month='2014-07' then rifle end) as rifle_2014_07,
	sum(case when month='2014-07' then total end) as total_2014_07,
	sum(case when month='2014-06' then handgun end) as handgun_2014_06,
	sum(case when month='2014-06' then rifle end) as rifle_2014_06,
	sum(case when month='2014-06' then total end) as total_2014_06,
	sum(case when month='2014-05' then handgun end) as handgun_2014_05,
	sum(case when month='2014-05' then rifle end) as rifle_2014_05,
	sum(case when month='2014-05' then total end) as total_2014_05,
	sum(case when month='2014-04' then handgun end) as handgun_2014_04,
	sum(case when month='2014-04' then rifle end) as rifle_2014_04,
	sum(case when month='2014-04' then total end) as total_2014_04,
	sum(case when month='2014-03' then handgun end) as handgun_2014_03,
	sum(case when month='2014-03' then rifle end) as rifle_2014_03,
	sum(case when month='2014-03' then total end) as total_2014_03,
	sum(case when month='2014-02' then handgun end) as handgun_2014_02,
	sum(case when month='2014-02' then rifle end) as rifle_2014_02,
	sum(case when month='2014-02' then total end) as total_2014_02,
	sum(case when month='2014-01' then handgun end) as handgun_2014_01,
	sum(case when month='2014-01' then rifle end) as rifle_2014_01,
	sum(case when month='2014-01' then total end) as total_2014_01,
	sum(case when month='2013-12' then handgun end) as handgun_2013_12,
	sum(case when month='2013-12' then rifle end) as rifle_2013_12,
	sum(case when month='2013-12' then total end) as total_2013_12,
	sum(case when month='2013-11' then handgun end) as handgun_2013_11,
	sum(case when month='2013-11' then rifle end) as rifle_2013_11,
	sum(case when month='2013-11' then total end) as total_2013_11,
	sum(case when month='2013-10' then handgun end) as handgun_2013_10,
	sum(case when month='2013-10' then rifle end) as rifle_2013_10,
	sum(case when month='2013-10' then total end) as total_2013_10,
	sum(case when month='2013-09' then handgun end) as handgun_2013_09,
	sum(case when month='2013-09' then rifle end) as rifle_2013_09,
	sum(case when month='2013-09' then total end) as total_2013_09,
	sum(case when month='2013-08' then handgun end) as handgun_2013_08,
	sum(case when month='2013-08' then rifle end) as rifle_2013_08,
	sum(case when month='2013-08' then total end) as total_2013_08,
	sum(case when month='2013-07' then handgun end) as handgun_2013_07,
	sum(case when month='2013-07' then rifle end) as rifle_2013_07,
	sum(case when month='2013-07' then total end) as total_2013_07,
	sum(case when month='2013-06' then handgun end) as handgun_2013_06,
	sum(case when month='2013-06' then rifle end) as rifle_2013_06,
	sum(case when month='2013-06' then total end) as total_2013_06,
	sum(case when month='2013-05' then handgun end) as handgun_2013_05,
	sum(case when month='2013-05' then rifle end) as rifle_2013_05,
	sum(case when month='2013-05' then total end) as total_2013_05,
	sum(case when month='2013-04' then handgun end) as handgun_2013_04,
	sum(case when month='2013-04' then rifle end) as rifle_2013_04,
	sum(case when month='2013-04' then total end) as total_2013_04,
	sum(case when month='2013-03' then handgun end) as handgun_201_03,
	sum(case when month='2013-03' then rifle end) as rifle_2013_03,
	sum(case when month='2013-03' then total end) as total_2013_03,
	sum(case when month='2013-02' then handgun end) as handgun_2013_02,
	sum(case when month='2013-02' then rifle end) as rifle_2013_02,
	sum(case when month='2013-02' then total end) as total_2013_02,
	sum(case when month='2013-01' then handgun end) as handgun_2013_01,
	sum(case when month='2013-01' then rifle end) as rifle_2013_01,
	sum(case when month='2013-01' then total end) as total_2013_01,
	sum(case when month='2012-12' then handgun end) as handgun_2012_12,
	sum(case when month='2012-12' then rifle end) as rifle_201_12,
	sum(case when month='2012-12' then total end) as total_2012_12,
	sum(case when month='2012-11' then handgun end) as handgun_2012_11,
	sum(case when month='2012-11' then rifle end) as rifle_2012_11,
	sum(case when month='2012-11' then total end) as total_2012_11,
	sum(case when month='2012-10' then handgun end) as handgun_2012_10,
	sum(case when month='2012-10' then rifle end) as rifle_2012_10,
	sum(case when month='2012-10' then total end) as total_2012_10,
	sum(case when month='2012-09' then handgun end) as handgun_2012_09,
	sum(case when month='2012-09' then rifle end) as rifle_2012_09,
	sum(case when month='2012-09' then total end) as total_2012_09,
	sum(case when month='2012-08' then handgun end) as handgun_2012_08,
	sum(case when month='2012-08' then rifle end) as rifle_2012_08,
	sum(case when month='2012-08' then total end) as total_2012_08,
	sum(case when month='2012-07' then handgun end) as handgun_2012_07,
	sum(case when month='2012-07' then rifle end) as rifle_2012_07,
	sum(case when month='2012-07' then total end) as total_2012_07,
	sum(case when month='2012-06' then handgun end) as handgun_2012_06,
	sum(case when month='2012-06' then rifle end) as rifle_2012_06,
	sum(case when month='2012-06' then total end) as total_2012_06,
	sum(case when month='2012-05' then handgun end) as handgun_2012_05,
	sum(case when month='2012-05' then rifle end) as rifle_2012_05,
	sum(case when month='2012-05' then total end) as total_2012_05,
	sum(case when month='2012-04' then handgun end) as handgun_2012_04,
	sum(case when month='2012-04' then rifle end) as rifle_2012_04,
	sum(case when month='2012-04' then total end) as total_2012_04,
	sum(case when month='2012-03' then handgun end) as handgun_2012_03,
	sum(case when month='2012-03' then rifle end) as rifle_2012_03,
	sum(case when month='2012-03' then total end) as total_2012_03,
	sum(case when month='2012-02' then handgun end) as handgun_2012_02,
	sum(case when month='2012-02' then rifle end) as rifle_2012_02,
	sum(case when month='2012-02' then total end) as total_2012_02,
	sum(case when month='2012-01' then handgun end) as handgun_2012_01,
	sum(case when month='2012-01' then rifle end) as rifle_2012_01,
	sum(case when month='2012-01' then total end) as total_2012_01,
	sum(case when month='2011-12' then handgun end) as handgun_2011_12,
	sum(case when month='2011-12' then rifle end) as rifle_2011_12,
	sum(case when month='2011-12' then total end) as total_2011_12,
	sum(case when month='2011-11' then handgun end) as handgun_2011_11,
	sum(case when month='2011-11' then rifle end) as rifle_2011_11,
	sum(case when month='2011-11' then total end) as total_2011_11,
	sum(case when month='2011-10' then handgun end) as handgun_2011_10,
	sum(case when month='2011-10' then rifle end) as rifle_2011_10,
	sum(case when month='2011-10' then total end) as total_2011_10,
	sum(case when month='2011-09' then handgun end) as handgun_2011_09,
	sum(case when month='2011-09' then rifle end) as rifle_2011_09,
	sum(case when month='2011-09' then total end) as total_2011_09,
	sum(case when month='2011-08' then handgun end) as handgun_2011_08,
	sum(case when month='2011-08' then rifle end) as rifle_2011_08,
	sum(case when month='2011-08' then total end) as total_2011_08,
	sum(case when month='2011-07' then handgun end) as handgun_2011_07,
	sum(case when month='2011-07' then rifle end) as rifle_2011_07,
	sum(case when month='2011-07' then total end) as total_2011_07,
	sum(case when month='2011-06' then handgun end) as handgun_2011_06,
	sum(case when month='2011-06' then rifle end) as rifle_2011_06,
	sum(case when month='2011-06' then total end) as total_2011_06,
	sum(case when month='2011-05' then handgun end) as handgun_2011_05,
	sum(case when month='2011-05' then rifle end) as rifle_2011_05,
	sum(case when month='2011-05' then total end) as total_2011_05,
	sum(case when month='2011-04' then handgun end) as handgun_2011_04,
	sum(case when month='2011-04' then rifle end) as rifle_2011_04,
	sum(case when month='2011-04' then total end) as total_2011_04,
	sum(case when month='2011-03' then handgun end) as handgun_201_03,
	sum(case when month='2011-03' then rifle end) as rifle_2011_03,
	sum(case when month='2011-03' then total end) as total_2011_03,
	sum(case when month='2011-02' then handgun end) as handgun_2011_02,
	sum(case when month='2011-02' then rifle end) as rifle_2011_02,
	sum(case when month='2011-02' then total end) as total_2011_02,
	sum(case when month='2011-01' then handgun end) as handgun_2011_01,
	sum(case when month='2011-01' then rifle end) as rifle_2011_01,
	sum(case when month='2011-01' then total end) as total_2011_01,
	sum(case when month='2010-12' then handgun end) as handgun_2010_12,
	sum(case when month='2010-12' then rifle end) as rifle_2010_12,
	sum(case when month='2010-12' then total end) as total_2010_12,
	sum(case when month='2010-11' then handgun end) as handgun_2010_11,
	sum(case when month='2010-11' then rifle end) as rifle_2010_11,
	sum(case when month='2010-11' then total end) as total_2010_11,
	sum(case when month='2010-10' then handgun end) as handgun_2010_10,
	sum(case when month='2010-10' then rifle end) as rifle_2010_10,
	sum(case when month='2010-10' then total end) as total_2010_10,
	sum(case when month='2010-09' then handgun end) as handgun_2010_09,
	sum(case when month='2010-09' then rifle end) as rifle_2010_09,
	sum(case when month='2010-09' then total end) as total_2010_09,
	sum(case when month='2010-08' then handgun end) as handgun_2010_08,
	sum(case when month='2010-08' then rifle end) as rifle_2010_08,
	sum(case when month='2010-08' then total end) as total_2010_08,
	sum(case when month='2010-07' then handgun end) as handgun_2010_07,
	sum(case when month='2010-07' then rifle end) as rifle_2010_07,
	sum(case when month='2010-07' then total end) as total_2010_07,
	sum(case when month='2010-06' then handgun end) as handgun_2010_06,
	sum(case when month='2010-06' then rifle end) as rifle_2010_06,
	sum(case when month='2010-06' then total end) as total_2010_06,
	sum(case when month='2010-05' then handgun end) as handgun_2010_05,
	sum(case when month='2010-05' then rifle end) as rifle_2010_05,
	sum(case when month='2010-05' then total end) as total_2010_05,
	sum(case when month='2010-04' then handgun end) as handgun_2010_04,
	sum(case when month='2010-04' then rifle end) as rifle_2010_04,
	sum(case when month='2010-04' then total end) as total_2010_04,
	sum(case when month='2010-03' then handgun end) as handgun_2010_03,
	sum(case when month='2010-03' then rifle end) as rifle_2010_03,
	sum(case when month='2010-03' then total end) as total_2010_03,
	sum(case when month='2010-02' then handgun end) as handgun_2010_02,
	sum(case when month='2010-02' then rifle end) as rifle_2010_02,
	sum(case when month='2010-02' then total end) as total_2010_02,
	sum(case when month='2010-01' then handgun end) as handgun_2010_01,
	sum(case when month='2010-01' then rifle end) as rifle_2010_01,
	sum(case when month='2010-01' then total end) as total_2010_01,
	sum(case when month='2009-12' then handgun end) as handgun_2009_12,
	sum(case when month='2009-12' then rifle end) as rifle_2009_12,
	sum(case when month='2009-12' then total end) as total_2009_12,
	sum(case when month='2009-11' then handgun end) as handgun_2009_11,
	sum(case when month='2009-11' then rifle end) as rifle_2009_11,
	sum(case when month='2009-11' then total end) as total_2009_11,
	sum(case when month='2009-10' then handgun end) as handgun_2009_10,
	sum(case when month='2009-10' then rifle end) as rifle_2009_10,
	sum(case when month='2009-10' then total end) as total_2009_10,
	sum(case when month='2009-09' then handgun end) as handgun_2009_09,
	sum(case when month='2009-09' then rifle end) as rifle_2009_09,
	sum(case when month='2009-09' then total end) as total_2009_09,
	sum(case when month='2009-08' then handgun end) as handgun_2009_08,
	sum(case when month='2009-08' then rifle end) as rifle_2009_08,
	sum(case when month='2009-08' then total end) as total_2009_08,
	sum(case when month='2009-07' then handgun end) as handgun_2009_07,
	sum(case when month='2009-07' then rifle end) as rifle_2009_07,
	sum(case when month='2009-07' then total end) as total_2009_07,
	sum(case when month='2009-06' then handgun end) as handgun_2009_06,
	sum(case when month='2009-06' then rifle end) as rifle_2009_06,
	sum(case when month='2009-06' then total end) as total_2009_06,
	sum(case when month='2009-05' then handgun end) as handgun_2009_05,
	sum(case when month='2009-05' then rifle end) as rifle_2009_05,
	sum(case when month='2009-05' then total end) as total_2009_05,
	sum(case when month='2009-04' then handgun end) as handgun_2009_04,
	sum(case when month='2009-04' then rifle end) as rifle_2009_04,
	sum(case when month='2009-04' then total end) as total_2009_04,
	sum(case when month='2009-03' then handgun end) as handgun_2009_03,
	sum(case when month='2009-03' then rifle end) as rifle_2009_03,
	sum(case when month='2009-03' then total end) as total_2009_03,
	sum(case when month='2009-02' then handgun end) as handgun_2009_02,
	sum(case when month='2009-02' then rifle end) as rifle_2009_02,
	sum(case when month='2009-02' then total end) as total_2009_02,
	sum(case when month='2009-01' then handgun end) as handgun_2009_01,
	sum(case when month='2009-01' then rifle end) as rifle_2009_01,
	sum(case when month='2009-01' then total end) as total_2009_01,
	sum(case when month='2008-12' then handgun end) as handgun_2008_12,
	sum(case when month='2008-12' then rifle end) as rifle_2008_12,
	sum(case when month='2008-12' then total end) as total_2008_12,
	sum(case when month='2008-11' then handgun end) as handgun_2008_11,
	sum(case when month='2008-11' then rifle end) as rifle_2008_11,
	sum(case when month='2008-11' then total end) as total_2008_11,
	sum(case when month='2008-10' then handgun end) as handgun_2008_10,
	sum(case when month='2008-10' then rifle end) as rifle_2008_10,
	sum(case when month='2008-10' then total end) as total_2008_10,
	sum(case when month='2008-09' then handgun end) as handgun_2008_09,
	sum(case when month='2008-09' then rifle end) as rifle_2008_09,
	sum(case when month='2008-09' then total end) as total_2008_09,
	sum(case when month='2008-08' then handgun end) as handgun_2008_08,
	sum(case when month='2008-08' then rifle end) as rifle_2008_08,
	sum(case when month='2008-08' then total end) as total_2008_08,
	sum(case when month='2008-07' then handgun end) as handgun_2008_07,
	sum(case when month='2008-07' then rifle end) as rifle_2008_07,
	sum(case when month='2008-07' then total end) as total_2008_07,
	sum(case when month='2008-06' then handgun end) as handgun_2008_06,
	sum(case when month='2008-06' then rifle end) as rifle_2008_06,
	sum(case when month='2008-06' then total end) as total_2008_06,
	sum(case when month='2008-05' then handgun end) as handgun_2008_05,
	sum(case when month='2008-05' then rifle end) as rifle_2008_05,
	sum(case when month='2008-05' then total end) as total_2008_05,
	sum(case when month='2008-04' then handgun end) as handgun_200_04,
	sum(case when month='2008-04' then rifle end) as rifle_2008_04,
	sum(case when month='2008-04' then total end) as total_2008_04,
	sum(case when month='2008-03' then handgun end) as handgun_2008_03,
	sum(case when month='2008-03' then rifle end) as rifle_2008_03,
	sum(case when month='2008-03' then total end) as total_2008_03,
	sum(case when month='2008-02' then handgun end) as handgun_2008_02,
	sum(case when month='2008-02' then rifle end) as rifle_2008_02,
	sum(case when month='2008-02' then total end) as total_2008_02,
	sum(case when month='2008-01' then handgun end) as handgun_2008_01,
	sum(case when month='2008-01' then rifle end) as rifle_2008_01,
	sum(case when month='2008-01' then total end) as total_2008_01,
	
from 
    "math264_panic_buying"
group by 
    state
order by 
    state
